---
tags: Cpp
---

# Modern [[cpp]]

[modern cpp tutorial](https://github.com/changkun/modern-cpp-tutorial)

## lambda 表达式

捕获列表可以是值/引用，值是 lambda 表达式创建时候拷贝，引用是调用时拷贝，分别可以用 `=`/`&` 让[[compile]]r 自动推导

```cpp
// lambda 表达式
[捕获列表](参数列表) mutable(可选) 异常属性 -> 返回类型 {
// 函数体
}
```

## 右值引用

- **左值(lvalue, left value)**，顾名思义就是赋值符号左边的值。准确来说， 左值是表达式（不一定是赋值表达式）后依然存在的持久对象。
- **右值(rvalue, right value)**，右边的值，是指表达式结束后就不再存在的临时对象。
  - 纯右值：纯粹的右值，要么是纯粹的字面量，例如  `10`, `true`； 要么是求值结果相当于字面量或匿名临时对象，例如  `1+2`。非引用返回的临时变量、运算表达式产生的临时变量、 原始字面量、Lambda 表达式都属于纯右值
  - 将亡值：即将被销毁、却能够被移动的值。如函数的返回值被右值转换降低开销

## 智能指针

包含在 `memory` 头文件中，采用引用计数，可以消除掉 `new` 和 `delete`

- `shared_ptr` ：够记录多少个  `shared_ptr`  共同指向一个对象，从而消除显式的调用  `delete`，当引用计数变为零的时候就会将对象自动删除。`std::make_shared<T>(value)` 代替了 `new`
  - `std::shared_ptr`  可以通过  `get()`  方法来获取原始指针，通过  `reset()`  来减少一个引用计数， 并通过`use_count()`来查看一个对象的引用计数
  - 无法解决循环引用
- `unique_ptr`：是一种独占的智能指针，它禁止其他智能指针与其共享同一个对象，从而保证代码的安全
  - 不可以复制，但可以 `std::move` 给其他值
- `weak_ptr`：是一种弱引用，不会引起引用计数增加。没有 `*` 运算符和 `->` 运算符，所以不能够对资源进行操作，它可以用于检查 `std::shared_ptr` 是否存在，也可以用于获取指向原始对象的 `std::shared_ptr` 指针。

[//begin]: # "Autogenerated link references for markdown compatibility"
[cpp]: cpp.md "Cpp"
[compile]: ../compilers/compile.md "编译原理"
[//end]: # "Autogenerated link references"
