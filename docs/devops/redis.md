---
tags: devops
---
# redis

作为一种Key-Value的No[[SQL]]，常用做缓存、[[数据库]]、消息队列等，基于内存，性能高

## 使用方法

查看key的值

```redis
get key
```

查看key的过期时间

```redis
ttl key
```

设置key的过期时间

```redis
expire key 10
```

设置key的值

```redis
set key value [EX seconds] [PX milliseconds] [NX|XX]
```

## 缓存管理机制

- 定期随机删除
- 惰性删除
- 内存淘汰机制

### 缓存穿透与缓存雪崩

- 缓存穿透：查询一个不存在的key，导致每次都要去数据库查询，造成数据库压力过大
- 缓存雪崩：缓存过期时间设置的过于集中，导致大量的key同时过期，造成数据库压力过大

解决方案：

- 缓存穿透：布隆过滤器
- 缓存雪崩：设置不同的过期时间

## 持久化

- RDB：定时将内存中的数据快照保存到磁盘中
- AOF：记录每次对数据库的修改操作，重启时重新执行

## 集群

### 高可用

- 主从复制：主节点负责写，从节点负责读
- 哨兵：监控主节点，当主节点宕机时，自动将从节点升级为主节点

### 数据分片

一致性哈希：将数据分布到多个节点上，当有节点宕机时，数据会自动迁移到其他节点上

[//begin]: # "Autogenerated link references for markdown compatibility"
[SQL]: ../database/sql.md "mysql"
[数据库]: ../database/数据库.md "数据库"
[//end]: # "Autogenerated link references"
