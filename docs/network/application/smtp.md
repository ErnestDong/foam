---
tags: network
---
# smtp

## 邮件系统

主要由用户代理、邮件服务器和 SMTP 组成，常用端口85。用户通过用户代理连接邮件服务器，典型的例子是

- Alice 撰写邮件发送到他的邮件服务器上
- 邮件服务器尝试给接收方，失败增定时重复，直到超过阈值报给 Alice

## SMTP 交换 message

message 必须满足全部是 ASCII 码，所有内容编码在一个报文内。客户端像服务器发送指令，如 `HELO` `MAIL FROM` `RCPT TO` `DATA` `QUIT`

与[[http]]类似，message 以 CRLF 结尾，但基本是一个 push protocol，发送者推向收件人；而非 http 的 pull protocol
![push protocol](../../attachments/smtp.png)

接收方接收消息的方式可以为：

- POP3：特许(明文发送用户名和密码到 110 端口)、事务处理、更新，是无状态的
- IMAP：更复杂，能操控远程服务器，并且可以获得报文的部分命令
- http：Gmail 等通过网页连接

[//begin]: # "Autogenerated link references for markdown compatibility"
[http]: http.md "http"
[//end]: # "Autogenerated link references"
