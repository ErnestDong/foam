---
tags: CSAPP, OS
---
# 异常控制流

程序计数器PC 是一个序列，每个元素 a 是某个相应的指令 I 的地址。每次从 $a_i$ 到 $a_{i+1}$ 的过度称为控制转移。这样的控制转移序列叫做控制流

现代系统通过使控制流发生突变来对这些情况做出反应。一般而言，我们把这些突变称为异常控制流（Exceptional Control Flow,ECF)。

异常就是控制流中的突变，用来响应[[处理器]]状态中的某些变化。

## 异常

![exceptions分类](./../../attachments/exceptions.png)

- 中断 Interrupt 是异步的，发生异常后 CPU 执行异常处理程序返回下一条指令，好像中断从未发生过一样
  - 同步异步指中断指令来自CPU内部还是外部，除中断外都是同步的
- 陷阱 Traps 是故意触发的异常(用于 IO、新建进程)，用户程序 syscall 触发异常执行系统调用返回下一条指令
- 故障 Faults 是由错误情况引起，如果故障处理程序能修复，则修复后重新执行引发故障的指令，否则 Abort
- 中止 Abort 是由不可恢复的致命错误导致的，不返回给程序直接结束

## [[进程]]与[[并发]]

[//begin]: # "Autogenerated link references for markdown compatibility"
[处理器]: ../计算机组成/处理器.md "处理器体系结构"
[进程]: <../../operating system/虚拟化/进程.md> "进程"
[并发]: ../程序的通信/并发.md "并发"
[//end]: # "Autogenerated link references"
