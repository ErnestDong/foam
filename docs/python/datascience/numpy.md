---
tags: python
---
# numpy

numpy 是底层为 C 的向量计算库，是 [[python]] 科学计算的基石，快速、贴近底层。

中文文档：<https://www.numpy.org.cn/> 英文文档：<https://numpy.org/doc/stable/user/index.html>

非常的底层，数值计算的基础

## numpy 基础数据类型

NumPy 包的核心是 ndarray 对象，是一种容器，类似于 python 的 list 和 C++ 的 array 。 它封装了 python 原生的同数据类型的 n 维数组，为了保证其性能优良，其中有许多操作都是代码在本地进行编译后执行的。

ndarray 有固定的大小、容器中是相同的数据类型（可以通过 dtype 访问）。 ndarray 通过 **矢量化** 加速程序运行

```python
arr = np.array([1,2,3,np.nan])
print(arr.astype(float))
print(arr.dtype)
```

请注意 numpy 的整数有可能溢出

### 数组的创建

1. 从其他 Python 结构（例如，列表，元组）转换

    `np.array(list_like)`

2. numpy 原生数组的创建

    numpy 提供了部分函数，可以创建特定的数组

    ```python
    shape = (1, 4)
    print(np.ones(shape))
    print(np.zeros(shape))
    print(np.random.random(shape))
    print(np.arange(0, 6, 2)) # 从0到6，每隔2个
    print(np.linspace(1., 4., 6)) # 从1到4，一共6个
    ```

## 索引与变形

shape 属性储存了 numpy 数组的“形状”，并且是可以修改的

```python
x = np.arange(10)
x.shape = 2, 5
print(x)
print(x[0])
print(x[0:2])
```

## 运算

### 算术运算符

数组上的算术运算符会应用到 **元素** 级别。下面是创建一个新数组并填充结果的示例：

```python
a = np.array( [20,30,40,50] )
b = np.arange( 4 )
c = a-b
print(c)
print(c**2)
print(10*np.sin(a))
print(a<35)
```

对于矩阵，乘法使用@

```python
A = np.array([[0, 1], [2, 3]])
B = np.array([[4, 5], [6, 7]])
print(A*B)
print(A@B)
```

### 一些方法

axis 参数可以指定操作的方向，沿着第几维

```python
x = np.array([[3, 1, 4, 1], [5, 9, 2, 6]])
print(x.min())
print(x.max())
print(x.mean(axis=0))
print(x.sum())
print(x.argmax())
print(x.cumsum(axis=1))
print(np.fromfunction(lambda i, j: i == j, (3, 3), dtype=int))
# The resulting array has a value fn(x, y, z) at coordinate (x, y, z).
```

### 广播

广播允许通用功能以有意义的方式处理不具有完全相同形状的输入。

广播的第一个规则是，如果所有输入数组不具有相同数量的维度，则将“1”重复地预先添加到较小数组的形状，直到所有数组具有相同数量的维度。

广播的第二个规则确保沿特定维度的大小为1的数组表现为具有沿该维度具有最大形状的数组的大小。假定数组元素的值沿着“广播”数组的那个维度是相同的。

[//begin]: # "Autogenerated link references for markdown compatibility"
[python]: ../python.md "python"
[//end]: # "Autogenerated link references"
