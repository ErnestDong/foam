---
tags: OS, CSAPP
---

# 系统级 IO

文件就是一串字节序列。IO 设备被抽象为文件，IO 变为“读”和“写”

## 文件

每个文件有自己的 type，如 regular file/directory/socket ......，[[C]] 中可以使用 `open` 函数打开并设置打开时的方式，如 `O_RDONLY` `O_WRONLY` `O_RDWR` 只读只写读写，以及 `O_CREAT` `O_TRUNC` `O_APPEND`，可以用位操作符连接

可以使用 `stat(filename)` 或 `fstat(fd)` 来获得文件的 metadata

### 文件描述符

文件描述符（File descriptor）是计算机科学中的一个术语，是一个用于表述指向文件的引用的抽象化概念。

在形式上是一个非负整数，是一个索引值，指向内核为每一个进程所维护的该进程打开文件的记录表。当程序打开一个现有文件或者创建一个新文件时，内核向进程返回一个文件描述符。

## 缓冲

缓存 I/O 又称为标准 I/O，大多数文件系统的默认 I/O 操作都是缓存 I/O。在 Linux 的缓存 I/O 机制中，操作系统会将 I/O 的数据缓存在文件系统的页缓存中，即数据会先被拷贝到操作系统内核的缓冲区中，然后才会从操作系统内核的缓冲区拷贝到应用程序的地址空间。

[//begin]: # "Autogenerated link references for markdown compatibility"
[C]: ../../cpp/C.md "C"
[//end]: # "Autogenerated link references"
