---
tags: Database
---

# ElasticSearch

## Lucene

ElasticSearch 是一个开源的分布式、RESTful 的搜索引擎 ，可以用来解决使用[[数据库]]进行模糊搜索时存在的性能问题，基于 Lucene。

Lucene 是一个 Java 语言编写的高性能、全功能的文本搜索引擎库，提供强大的索引和搜索功能，以及拼写检查、高亮显示和高级分析功能，但并没有分布式以及高可用的解决方案。

ElasticSearch 封装了许多 Lucene 底层功能，提供了简单易用的 RestFul API 接口和多种语言的客户端，开箱即用，自带分布式以及高可用的解决方案。

## 核心技术

- 倒排索引：建立`{value: [key1, key2]}`的索引，并把[[index]]用有限状态机 FST 压缩索引大小
- 分词技术：搜索`dogs`和`dog`匹配到相同结果
- 压缩：`[key1, key2]`可能会很多，压缩算法 Frame of Reference 节约空间
- 缓存：ES 的 `filter` 语句采用了 Roaring Bitmap 技术来缓存搜索结果，保证高频 `filter` 查询速度的同时降低存储空间消耗。
- 联查：在有 filter cache 的情况下，会直接利用位图的原生特性快速求交并集得到联合查询结果，否则使用[[跳表]]对多个 postings list 求交并集，跳过遍历成本并且节省部分数据的解压缩 cpu 成本。

## 应用场景

- 网站关键词搜索
- ELK 日志采集系统中的日志搜索

[//begin]: # "Autogenerated link references for markdown compatibility"
[数据库]: ../数据库.md "数据库"
[index]: <../database systems/index.md> "索引"
[跳表]: ../../algorithm/data_structure/跳表.md "跳表"
[//end]: # "Autogenerated link references"
