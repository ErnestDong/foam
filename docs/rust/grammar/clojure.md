---
tags: rust
---

# 闭包

闭包是一种匿名函数，它可以赋值给变量也可以作为参数传递给其它函数，不同于函数的是，它允许捕获调用者作用域中的值

```rust
fn main() {
    let x = 1;
    let sum = |y| x + y;
    assert_eq!(3, sum(2));
}
```

## 捕获变量的方式及[[trait]]

- `FnOnce`：捕获所有权的变量，闭包拥有这些变量的所有权，闭包结束后变量被销毁
  - 如果你想强制闭包取得捕获变量的所有权，可以在参数列表前添加 `move` 关键字，这种用法通常用于闭包的生命周期大于捕获变量的生命周期时，例如将闭包返回或移入其他线程。
- `FnMut`：捕获可变引用的变量，闭包可以改变这些变量的值
- `Fn`：捕获不可变借用的变量，闭包只能读取这些变量的值

Clojure 作为返回值需要[[rust智能指针]]

[//begin]: # "Autogenerated link references for markdown compatibility"
[trait]: ../concept/trait.md "trait"
[//end]: # "Autogenerated link references"
